<!DOCTYPE html>
<html>
<head>
  <title>Rating Motion Plans</title>
  <script src="jsPsych-lite/jspsych.js"></script>
  <script src="jsPsych-lite/plugins/jspsych-custom-video-form-inputs.js"></script>
  <script src="jsPsych-lite/plugins/jspsych-survey-text.js"></script>
  <link rel="stylesheet" href="jsPsych-lite/css/perceptive-csa.css"></link>
  <style>
    img {
      width: 800px;
    }
    /* Chrome, Safari, Edge, Opera */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    /* Firefox */
    input[type=number] {
      -moz-appearance: textfield;
    }
  </style>
</head>
<body></body>


<script>

  const colors = ["rgb(50,168,82)"]//, "rgb(158, 24, 24)", "rgb(18, 73, 201)","rgb(241, 135, 11)","rgb(113, 9, 166)"] // green, red, blue, yellow
  const annotation_opts = ['good']//,'comfortable','safe','efficient','lawful']

  const file_path = 'test_stims/'
  const stimuli = ['config1.webm']//['example1.m4v']//,'example2.m4v']
  var timeline = []


   // check subject's understanding of intstructions
   var user_id_trial = {
        type: 'survey-text',
        questions: [
            { prompt: "Welcome to Motion Path Rating! User Name: ", name: 'user_id'}//, placeholder: "City, State/Province, Country" }
            ],
        on_finish: function(data){
            var id = JSON.parse(data.responses).user_id.toLowerCase();
            console.log(id)
            jsPsych.data.addProperties({user: id});
            },
    };

    timeline.push(user_id_trial);


  // can add trials for each annotation_opt
  for (var opt = 0; opt < annotation_opts.length; opt++) {
    for (var n = 0; n < stimuli.length; n++){

        var trial = {
            type: 'custom-video-form-inputs',
            stimulus: file_path+ stimuli[n],
            prompt: 'How <span style="font-weight:bold; color:'+colors[opt]+'">'+
                    annotation_opts[opt] +' </span> is this motion path?',
            form_html: '<label for="'+annotation_opts[opt] +'" style="font-size:12px"> Rating from 1-100: </label>' +
            '<input type="number" id="response" name="'+annotation_opts[opt] +'" min="1" max="100" style="width:50px">',
            delay_form: false,
            submit_keys: ['return','space'],
            question_type: annotation_opts[opt]
        }
        timeline.push(trial);
    }
}

  jsPsych.init({
    timeline: timeline,
    on_finish: function() {
      jsPsych.data.displayData('json');
      var data = jsPsych.data.get().filter({trial_type: 'custom-video-form-inputs'})
      console.log(data)

    },
    default_iti: 250
  });
</script>

</html>
